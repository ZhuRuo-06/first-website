<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Demo Comment</title>
</head>
<body>
<section id="comments">
  <h3>Komentar</h3>

  <div id="comment-list"></div>

  <form id="comment-form">
    <input id="name" placeholder="Nama" required>
    <textarea id="message" placeholder="Tulis komentar..." required></textarea>
    <button>Kirim</button>
  </form>
</section>

<script>
const API = "https://comment-section.vercel.app/api/comments?path=" + location.pathname;

async function loadComments(){
  const res = await fetch(API);
  const data = await res.json();
  const box = document.getElementById("comment-list");
  box.innerHTML = data.map(c =>
    `<div><b>${c.name}</b><p>${c.message}</p></div>`
  ).join("");
}

document.getElementById("comment-form").onsubmit = async e => {
  e.preventDefault();
  await fetch(API,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({
      name: name.value,
      message: message.value
    })
  });
  e.target.reset();
  loadComments();
};

loadComments();
</script>

</body>
</html>

